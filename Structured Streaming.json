{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541312778476_-2098524863","id":"20181104-115618_1482584686","dateCreated":"2018-11-04T11:56:18+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:296","text":"// create a stream and listen on a port\n\ndef createStream(port: Int, duration: Int) {\n    val lines = (spark.readStream\n        .format(\"socket\")\n        .option(\"host\", \"localhost\")\n        .option(\"port\", port)\n        .load())\n\n    val words = (lines\n        .as[String]\n        .flatMap(_.split(\"\\\\s+\")))\n\n    val wordCounts = (words\n        .groupByKey(_.toLowerCase)\n        .count()\n        .orderBy($\"count(1)\" desc))\n\n    val query = (wordCounts.writeStream\n        .outputMode(\"complete\")\n        .format(\"console\")\n        .start\n        .awaitTermination(duration))\n}","dateUpdated":"2018-11-04T11:58:58+0530","dateFinished":"2018-11-04T11:59:41+0530","dateStarted":"2018-11-04T11:58:58+0530","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one feature warning; re-run with -feature for details\ncreateStream: (port: Int, duration: Int)Unit\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541312938890_1535669747","id":"20181104-115858_979660621","dateCreated":"2018-11-04T11:58:58+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:433","text":"// run `nc -lk 12341` in bash and start typing!\n\ncreateStream(12341, 10000)","dateUpdated":"2018-11-04T12:00:08+0530","dateFinished":"2018-11-04T12:00:25+0530","dateStarted":"2018-11-04T12:00:08+0530","errorMessage":""},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1541313008763_978808008","id":"20181104-120008_1206229595","dateCreated":"2018-11-04T12:00:08+0530","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:530"}],"name":"Structured Streaming","id":"2DWYWKWE2","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}